# Configuración principal para BankChurn Predictor
# Archivo: configs/config.yaml

# Configuración de datos
data:
  target_column: "Exited"
  drop_columns: 
    - "RowNumber"
    - "CustomerId" 
    - "Surname"
  
  categorical_features:
    - "Geography"
    - "Gender"
  
  numerical_features:
    - "CreditScore"
    - "Age"
    - "Tenure"
    - "Balance"
    - "NumOfProducts"
    - "HasCrCard"
    - "IsActiveMember"
    - "EstimatedSalary"

# Configuración de entrenamiento
training:
  test_size: 0.2
  validation_size: 0.2
  random_state: 42
  stratify: true
  
  # Validación cruzada
  cv_folds: 5
  cv_shuffle: true
  
  # Métricas de evaluación
  primary_metric: "f1"
  secondary_metrics:
    - "roc_auc"
    - "precision"
    - "recall"
    - "accuracy"

# Configuración del modelo
model:
  type: "ensemble"  # ensemble, single
  resampling_strategy: "oversample"  # oversample, undersample, none
  
  # Configuración de ensemble
  ensemble:
    voting: "soft"  # soft, hard
    weights: [0.4, 0.6]  # [LogisticRegression, RandomForest]
  
  # Hiperparámetros de modelos base
  logistic_regression:
    C: 0.1
    class_weight: "balanced"
    solver: "liblinear"
    max_iter: 1000
  
  random_forest:
    n_estimators: 100
    max_depth: 10
    min_samples_split: 10
    min_samples_leaf: 5
    class_weight: "balanced_subsample"

# Configuración de optimización de hiperparámetros
hyperparameter_optimization:
  method: "optuna"  # optuna, randomized_search, grid_search
  n_trials: 100
  timeout: 3600  # segundos
  
  # Espacio de búsqueda
  search_space:
    lr_C: [0.01, 10.0]  # log scale
    rf_n_estimators: [50, 200]
    rf_max_depth: [5, 20]
    rf_min_samples_split: [5, 20]
    ensemble_lr_weight: [0.1, 0.9]

# Configuración de preprocesamiento
preprocessing:
  # Encoding categórico
  categorical_encoding:
    method: "onehot"
    drop_first: true
    handle_unknown: "ignore"
  
  # Escalado numérico
  numerical_scaling:
    method: "standard"  # standard, minmax, robust
  
  # Feature engineering
  feature_engineering:
    create_interactions: false
    create_polynomials: false
    polynomial_degree: 2

# Configuración de evaluación
evaluation:
  # Métricas de clasificación
  classification_metrics:
    - "accuracy"
    - "precision"
    - "recall"
    - "f1"
    - "roc_auc"
    - "matthews_corrcoef"
  
  # Análisis de errores
  error_analysis:
    confusion_matrix: true
    classification_report: true
    feature_importance: true
  
  # Bootstrap para intervalos de confianza
  bootstrap:
    n_iterations: 1000
    confidence_level: 0.95

# Configuración de logging
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  
  handlers:
    file:
      enabled: true
      filename: "logs/bankchurn.log"
      max_bytes: 10485760  # 10MB
      backup_count: 5
    
    console:
      enabled: true
      stream: "stdout"

# Configuración de paths
paths:
  data:
    raw: "data/raw/"
    processed: "data/processed/"
  
  models:
    directory: "models/"
    filename_template: "best_model_{timestamp}.pkl"
    preprocessor_template: "preprocessor_{timestamp}.pkl"
  
  results:
    directory: "results/"
    metrics: "results/metrics/"
    plots: "results/plots/"
    reports: "results/reports/"

# Configuración de API
api:
  host: "0.0.0.0"
  port: 8000
  reload: false
  
  # Límites de rate limiting
  rate_limits:
    requests_per_minute: 1000
    batch_size_limit: 1000
  
  # Configuración de CORS
  cors:
    allow_origins: ["*"]
    allow_methods: ["GET", "POST"]
    allow_headers: ["*"]

# Configuración de deployment
deployment:
  environment: "development"  # development, staging, production
  
  docker:
    image_name: "bankchurn-predictor"
    tag: "latest"
    port_mapping: "8000:8000"
  
  monitoring:
    health_check_interval: 30  # segundos
    metrics_collection: true
    log_predictions: false  # Solo en development

# Configuración de seguridad
security:
  api_key_required: false
  rate_limiting: true
  input_validation: true
  
  # Configuración de secrets (usar variables de entorno)
  secrets:
    model_encryption_key: null
    api_secret_key: null
